<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Tweets</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>

</head>

<script>
{% block jquery %}
var endpoint = '/api/chart/data/'
var labels = []
var tweet_stock = []
var tweet_ma = []
var daily_tweet_sentiment = []
var daily_like_sentiment = []
$.ajax({
	method: "GET",
	url: endpoint,
	success: function(data){
		labels = data.labels
		tweet_stock = data.tweet_stock
		tweet_ma = data.tweet_ma
		daily_tweet_sentiment = data.daily_tweet_sentiment
		daily_like_sentiment = data.daily_like_sentiment
		//console.log(data.labels)

		var ctx = document.getElementById("myChart");

		  var lineChart = new Chart(ctx, {
			type: 'line',
			markerType: "none",	
			data: {
				labels: labels,
				datasets: [{
					label: "Tweet Stock",
					markerType: "none",
					data: tweet_stock,
					borderColor: "#3e95cd",
					fill: false,
				}, {
					label: 'Tweet 10-Day MA',
					markerType: "none",	
					data: tweet_ma,
					borderColor: "#8e5ea2",
					fill: false,
				}]
			},
			options: {
				scales: {
					xAxes: [{
						time: {
							unit: 'month'
						}
					}]
				}
			}
		})
		// chart 2
		var ctx2 = document.getElementById("myChart2");

		  var lineChart2 = new Chart(ctx2, {
			type: 'line',
        	markerType: "none",
			data: {
				labels: labels,
				datasets: [{
					label: "Tweets",
					data: daily_tweet_sentiment,
					borderColor: "#ff4e00",
					fill: false,
				}, {
					label: 'Likes',
					data: daily_like_sentiment,
					borderColor: "#3be8b0",
					fill: false,
				}]
			},
			options: {
				scales: {
					xAxes: [{
						time: {
							unit: 'month'
						}
					}]
				}
			}
		})
	},		    



	error: function(error_data){
		console.log("error")
		console.log(error_data)
	}
})



{% endblock %}
</script>


<body>
	<div class="row">
		<div name='username' class="col-sm-3">
			{{ username }}
		</div>
		<div class="col-sm-3">
			Positive Tweets: {{ positives }}
		</div>
		<div class="col-sm-3">
			Neutral Tweets: {{ neutrals }}
		</div>
		<div class="col-sm-3">
			Negative Tweets: {{ negatives }}
		</div>
	</div>

	<br>
	<br>
	
	<div class="row justify-content-center" >
		<div class="col-lg-12">
			<canvas id="myChart" height="75"></canvas>
			<canvas id="myChart2" height="50"></canvas>
		</div>
	</div>


</body>


<div class="row">
	<div class="col-lg-6">
		<h2>TWEETS</h2>
		{% for tweet in tweets %}

		{{tweet}}
		<br/>

		{% endfor %}
	</div>


	<div class="col-lg-6">
		<h2>LIKES</h2>
		{% for like in likes %}

		{{like}}


		{% endfor %}
		<br/>		
		
	</div>





</div>

<a href="{% url 'home'%}">Start Again</a>
</html>